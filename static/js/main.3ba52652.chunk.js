(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{161:function(e,t,n){e.exports=n(325)},166:function(e,t,n){},167:function(e,t,n){},241:function(e,t){},243:function(e,t){},317:function(e,t){},318:function(e,t){},325:function(e,t,n){"use strict";n.r(t);var o=n(1),a=n.n(o),r=n(7),i=n.n(r),c=(n(166),n(145)),l=n(146),s=n(158),m=n(147),u=n(159),p=(n(167),n(327)),d=n(330),f=n(11),g=n(331),v=n(329);var h=function(e){var t=function(e){var t=[];for(var n in e){var o=[];for(var a in e[n])o.push({topic:a,value:e[n][a]});t.push({name:n,values:o})}return t}(e.alarms);return a.a.createElement("div",null,t.map(function(e){return a.a.createElement("div",null,a.a.createElement(v.a,{title:e.name,style:{background:"#FAFAFA"}},a.a.createElement("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap"}},e.values.map(function(e){return a.a.createElement(v.a,{title:e.topic,style:{width:"200px",margin:"5px 5px",background:"#EFFBFB"}},e.value)}))))}))},E=n(328),y=function(e){return a.a.createElement("div",null,a.a.createElement(E.a,{dataSource:e.logs,itemLayout:"horizontal",renderItem:function(e){return a.a.createElement(E.a.Item,{style:{margin:"2px 3px",padding:"5px",minHeight:"20px",marginBottom:"10px"}},a.a.createElement(E.a.Item.Meta,{title:a.a.createElement("div",{style:{fontSize:"20px"}},e.timestamp),description:a.a.createElement("div",{style:{fontSize:"20px"}},e.station," active for ",e.time)}))}}))},b=n(157),w=n(156),x=n.n(w);function S(e,t){var n=fetch("assets/config/settings.json").then(function(e){return e.json()}).catch(function(e){return console.log(e)}),o={keepalive:10,clientId:"mqttjs_"+Math.random().toString(16).substr(2,8),protocolId:"MQTT",protocolVersion:4,clean:!0,reconnectPeriod:1e3,connectTimeout:5e3,will:{topic:"WillMsg",payload:"Connection Closed abnormally..!",qos:0,retain:!1},rejectUnauthorized:!1},a={};e({message:"Connecting ",color:"info"}),t(a);var r=null;return n.then(function(n){o.username=n.user_name,o.password=n.password,o.protocol=n.protocol,o.servers=[{host:n.mqtt_server,port:n.port,protocol:n.protocol}];var i=x.a.connect(o);n.devices.forEach(function(e){i.subscribe("".concat(e,"/dio/#")),i.subscribe("".concat(e,"/temp/#"))}),console.log("connection sub",n.mqtt_server),e({message:"Connecting ",color:"warning"}),function(t){t.on("connect",function(){console.log("Connected"),e({message:"Connection succeessful",color:"success"})}),t.on("reconnect",function(){console.log("connecting error"),t.connected||e({message:"connection failed",color:"error"})}),t.on("error",function(){console.log("connection error"),e({message:"connection failed ",color:"error"})})}(i),function(e){console.log("_registerChanges"),e.on("message",function(e,n){var o=e.split("/"),r=Object(b.a)(o,3),i=r[0],c=r[1],l=r[2];void 0===a[i]&&(a[i]={});var s=n.toString();"dio"===c&&(s="1"===s?"ON":"OFF"),a[i][l]=s,t(a)})}(i),r=function(){console.log("disconnecting"),i.end(!0)}}),r}var k=p.a.Header,C=p.a.Content,I=p.a.Footer,j=p.a.Sider,M={log:[{timestamp:"21/06/2019 05:02:00 PM",station:"Station 1",time:"00:15:00"},{timestamp:"21/06/2019 05:01:00 PM",station:"Station 2",time:"00:12:00"},{timestamp:"21/06/2019 04:01:00 PM",station:"Station 3",time:"00:23:45"}]},O=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(s.a)(this,Object(m.a)(t).call(this,e))).mqtt_sub=void 0,n.timerID=void 0,n.onCollapse=function(e){n.setState({collapsed:e})},n.onSelect=function(e){n.setState({content:e.key})},n.state={collapsed:!1,content:"1",alarms:{},timeout:!1,updateTime:0,status:{color:"info",message:"Initializing"}},n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.mqtt_sub=S(function(t){e.setState({status:t})},function(t){e.setState({alarms:t,updateTime:Date.now(),timeout:!1})}),this.timerID=setInterval(function(){Date.now()-e.state.updateTime>3900&&e.setState({timeout:!0})},4e3)}},{key:"componentWillUnmount",value:function(){this.mqtt_sub()}},{key:"render",value:function(){var e=this;return a.a.createElement(p.a,{style:{minHeight:"100vh"}},a.a.createElement(j,{collapsible:!0,collapsed:this.state.collapsed,onCollapse:this.onCollapse},a.a.createElement("div",{className:"logo",style:{margin:"5px 10px"}}),a.a.createElement(d.b,{theme:"dark",defaultSelectedKeys:["1"],mode:"inline",onSelect:this.onSelect},a.a.createElement(d.b.Item,{key:"1"},a.a.createElement(f.a,{type:"warning"}),a.a.createElement("span",null,"Alarms")),a.a.createElement(d.b.Item,{key:"2"},a.a.createElement(f.a,{type:"database"}),a.a.createElement("span",null,"Report")))),a.a.createElement(p.a,null,a.a.createElement(k,{style:{background:"#fff",padding:0,textAlign:"center",fontSize:20}},a.a.createElement("div",{style:{marginBottom:"10px"}},a.a.createElement("h1",{className:"title-header",style:{textTransform:"uppercase",textOverflow:"ellipsis"}},"Chiller Monitor"),a.a.createElement(g.a,{message:this.state.status.message,type:this.state.status.color,showIcon:!0,style:{textAlign:"left",fontSize:15,textOverflow:"ellipsis",textJustify:"inter-word",textTransform:"capitalize"}}))),a.a.createElement(C,{style:{margin:"16px"}},a.a.createElement("div",{style:{padding:24,background:"#fff",minHeight:360,marginTop:"20px"}},function(){switch(e.state.content){case"1":return a.a.createElement(h,{alarms:e.state.alarms});case"2":return a.a.createElement(y,{logs:M.log});default:return a.a.createElement("div",null,"Unknown option selected")}}())),a.a.createElement(I,{style:{textAlign:"center"}},"Chiller Monitor 2019 Created by Aimtech")))}}]),t}(a.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(O,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[161,1,2]]]);
//# sourceMappingURL=main.3ba52652.chunk.js.map